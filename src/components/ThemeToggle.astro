<theme-toggle>
  <button
    id="theme-toggle"
    class="relative w-16 h-8 rounded-full bg-gray-300 dark:bg-gray-700 transition-all flex items-center"
    aria-pressed="false"
  >
    <!-- Sliding knob -->
    <span
      class="knob absolute left-1 bg-white w-6 h-6 rounded-full shadow transition-all duration-300"
    ></span>
  </button>
</theme-toggle>

<script>
  class ThemeToggle extends HTMLElement {
    constructor() {
      super();
    }

    connectedCallback() {
      const button = this.querySelector("#theme-toggle");
      if (!button) return;

      const knob = button.querySelector(".knob");
      if (!knob) return; // Prevents null errors

      // Function to toggle the theme
      const setTheme = (dark) => {
        if (dark) {
          document.documentElement.classList.add("dark");
          localStorage.setItem("theme", "dark");
          button.setAttribute("aria-pressed", "true");

          // Move Right
          knob.classList.remove("left-1");
          knob.classList.add("left-8");
        } else {
          document.documentElement.classList.remove("dark");
          localStorage.setItem("theme", "light");
          button.setAttribute("aria-pressed", "false");

          // Move Left
          knob.classList.remove("left-8");
          knob.classList.add("left-1");
        }
      };

      // Toggle the theme on button click
      button.addEventListener("click", () => {
        const darkModeEnabled =
          document.documentElement.classList.contains("dark");
        setTheme(!darkModeEnabled);
      });

      // Initialize the theme based on localStorage or default to light
      setTheme(localStorage.getItem("theme") === "dark");
    }
  }

  // Define the custom element
  customElements.define("theme-toggle", ThemeToggle);
</script>
